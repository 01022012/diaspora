-#   Copyright (c) 2010-2011, Diaspora Inc.  This file is
-#   licensed under the Affero General Public License version 3 or later.  See
-#   the COPYRIGHT file.

%ul#aspect_nav.left_nav.sub
  %li.all_aspects
    = link_to t('aspects.index.your_aspects'), aspects_path, :class => 'home_selector'

    - if @stream.is_a?(Stream::Aspect)
      %ul.sub_nav
        - if defined?(stream)
          %a.toggle_selector{:href => '#'}
            = stream.for_all_aspects? ? t('.deselect_all') : t('.select_all')
        - for aspect in all_aspects
          %li{:data => {:aspect_id => aspect.id}, :class => ("active" if defined?(stream) && stream.aspect_ids.include?(aspect.id))}
            .edit
              = link_to image_tag("icons/pencil.png", :title => t('.edit_aspect', :name => aspect.name)), edit_aspect_path(aspect), :rel => "facebox"
            %a.aspect_selector{:href => aspects_path("a_ids[]" => aspect.id), :class => "name", 'data-guid' => aspect.id}
              = aspect

        %li
          = link_to t('.add_an_aspect'), new_aspect_path, :class => "new_aspect", 'data-controls-modal' => 'new-aspect-pane', 'data-backdrop' => "static"


#new-aspect-pane.modal.fade
  .modal-header
    = link_to "x", "#", :class => "close"
    %h3
      = t('contacts.index.add_a_new_aspect')

  = form_for(Aspect.new, :remote => @remote) do |aspect|
    = aspect.error_messages
    %fieldset
      .modal-body
        - if @person_id
          = aspect.hidden_field :person_id, :value => @person_id
        .clearfix
          = aspect.label :name , t('aspects.new.name')
          .input
            = aspect.text_field :name, :maxlength => 20
            %span.help-block
              Name will not be visible to others

        .clearfix
          = aspect.label :contacts_visible, t('aspects.edit.make_aspect_list_visible')
          .input
            = aspect.check_box :contacts_visible, :default => true

      .modal-footer
        = aspect.submit t('.create'), :class => 'btn primary'
